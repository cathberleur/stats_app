---
title: "Analyse factorielle"
author: "Meyer, Berleur, Sklenard, Bracq"
date: "05/02/2023"
output: html_document
---
header-includes:
- \usepackage{fancyhdr}
- \pagestyle{fancy}
- \fancyhead{}
- \fancyfoot{}
- \fancyhead[CO,CE]{Poing Levé}
- \fancyfoot[CO,CE]{Sondage}
- \fancyfoot[R]{\thepage}
output:
  pdf_document:
    toc: yes
    toc_depth : 3
    latex_engine: xelatex
  html_document:
    toc: yes
editor_options: 
  markdown: 
    wrap: sentence
---

```{=html}
<style>
body {
text-align: justify}
</style>
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)

```

Il faut d'abord créer une table avec les communes comme individus...

Merger par identifiant de commune et ne conserver qu'une des trois adresses en sommant par vict/mec/lien -> group_by puis summarize avec nvic = n()


```{r}
df_com_inf <- merge(x=zonages, y=df_1619, by.x='CODGEO', by.y='cog_com_22_inf', all.x=TRUE)#on créé une base avec les communes comme identifiant avec les zonages
df_facto_inf <- df_com_inf %>%
  group_by(CODGEO) %>%
  summarise(sum = sum(), ninf = n())#on compte le nombre d'infraction par commune

#pareil pour les victimes
df_com_vict <- merge(x=zonages, y=df_1619, by.x='CODGEO', by.y='cog_com_22_vict', all.x=TRUE)
df_facto_vict <- df_com_vict %>%
  group_by(CODGEO) %>%
  summarise(sum = sum(), nvict = n())

#pareil pour les mec
df_com_mec <- merge(x=zonages, y=df_1619, by.x='CODGEO', by.y='cog_com_22_mec', all.x=TRUE)
df_facto_mec <- df_com_mec %>%
  group_by(CODGEO) %>%
  summarise(sum = sum(), nmec = n())

#on merge les trois tables
df_com_facto_mec_inf <- merge(x=df_facto_mec, y=df_facto_inf, by.x='CODGEO', by.y='CODGEO', all.x=TRUE)

df_facto <- merge(x=df_com_facto_mec_inf, y=df_facto_vict, by.x='CODGEO', by.y='CODGEO', all.x=TRUE)

#ça créé plein de bases qui servent à rien et des colonnes sum vides mais bon l'essentiel y est ^^

```



